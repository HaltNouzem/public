function FindProxyForURL(url, host) { /* Normalize the URL for pattern matching */ url = url.toLowerCase(); host = host.toLowerCase(); var hostOrDomainIs = function(host, val) { return (host === val) || dnsDomainIs(host, '.' + val); }; var hostIs = function(host, val) { return (host === val); }; /* Don't proxy local hostnames */ if (isPlainHostName(host)) { return 'DIRECT'; } /* Route domains through proxy regardless of destination IP address exceptions */ if ( hostOrDomainIs(host, "login.microsoftonline.com") || hostOrDomainIs(host, "login.microsoft.com") || hostOrDomainIs(host, "login.windows.net")) { return 'PROXY safeview-8ssa81089-quangnguyen.devatron.net:3129; DIRECT'; } /* Don't check IPv6 addresses */ if (isResolvable(host)) { var hostIP = dnsResolve(host); if (!shExpMatch(hostIP, "*:*")) { /* Don't proxy non-routable addresses (RFC 3330) */ if (isInNet(hostIP, '0.0.0.0', '255.0.0.0') || isInNet(hostIP, '10.0.0.0', '255.0.0.0') || isInNet(hostIP, '127.0.0.0', '255.0.0.0') || isInNet(hostIP, '169.254.0.0', '255.255.0.0') || isInNet(hostIP, '172.16.0.0', '255.240.0.0') || isInNet(hostIP, '192.0.2.0', '255.255.255.0') || isInNet(hostIP, '192.88.99.0', '255.255.255.0') || isInNet(hostIP, '192.168.0.0', '255.255.0.0') || isInNet(hostIP, '198.18.0.0', '255.254.0.0') || isInNet(hostIP, '224.0.0.0', '240.0.0.0') || isInNet(hostIP, '240.0.0.0', '240.0.0.0')) { return 'DIRECT'; } } } /* All other service traffic goes through proxy */ if ( dnsDomainIs(host, "menlosecurity.com") ) { return 'PROXY safeview-8ssa81089-quangnguyen.devatron.net:3129; DIRECT'; } /* List all default domains */ if ( shExpMatch(host, "google.??") || shExpMatch(host, "google.com") || shExpMatch(host, "google.com.??") || shExpMatch(host, "google.co.??") || shExpMatch(host, "*.google.??") || shExpMatch(host, "*.google.com") || shExpMatch(host, "*.google.com.??") || shExpMatch(host, "*.google.co.??")) { return 'DIRECT'; } if ( dnsDomainIs(host, ".windowsupdate.microsoft.com") || dnsDomainIs(host, ".update.microsoft.com") || dnsDomainIs(host, ".download.microsoft.com") || dnsDomainIs(host, ".ntservicepack.microsoft.com") || dnsDomainIs(host, ".cdm.microsoft.com") || dnsDomainIs(host, ".wustat.windows.com") || dnsDomainIs(host, "store-images.s-microsoft.com") || dnsDomainIs(host, "musicimage.xboxlive.com") || dnsDomainIs(host, "store-images.microsoft.com") || dnsDomainIs(host, "mediadiscovery.microsoft.com") || dnsDomainIs(host, "media-assetcatalog.microsoft.com") || dnsDomainIs(host, "mp.microsoft.com") || dnsDomainIs(host, "sls.microsoft.com")) { return 'DIRECT'; } if ( dnsDomainIs(host, "aus4.mozilla.org") || dnsDomainIs(host, "aus5.mozilla.org") || dnsDomainIs(host, "download.mozilla.org") || dnsDomainIs(host, "download.cdn.mozilla.net") || dnsDomainIs(host, "self-repair.mozilla.org")) { return 'DIRECT'; } if ( dnsDomainIs(host, ".webex.com") || dnsDomainIs(host, ".ciscowebex.com") || hostOrDomainIs(host, "gotomeeting.com") || hostOrDomainIs(host, "gotowebinar.com") || hostOrDomainIs(host, "gototraining.com") || hostOrDomainIs(host, "gotomypc.com") || hostOrDomainIs(host, "gotoassist.com") || hostOrDomainIs(host, "skype.com") || hostOrDomainIs(host, "freeconferencecall.com") || hostOrDomainIs(host, "join.me") || hostOrDomainIs(host, "anymeeting.com") || hostOrDomainIs(host, "clickwebinar.com") || hostOrDomainIs(host, "readytalk.com") || hostOrDomainIs(host, "omnovia.com") || hostOrDomainIs(host, "on24.com")) { return 'DIRECT'; } if ( hostOrDomainIs(host, "netflix.com") || hostOrDomainIs(host, "netflix.net") || hostOrDomainIs(host, "nflximg.com") || hostOrDomainIs(host, "nflximg.net") || hostOrDomainIs(host, "nflxvideo.net") || hostOrDomainIs(host, "nflxext.com") || hostOrDomainIs(host, "nflximg.com.edgesuite.net") || isInNet(host, "216.21.170.128","255.255.255.240") || isInNet(host, "192.173.64.0","255.255.192.0") || isInNet(host, "198.45.48.0","255.255.240.0") || isInNet(host, "216.21.170.96","255.255.255.240") || isInNet(host, "108.175.32.0","255.255.240.0") || isInNet(host, "198.38.96.0","255.255.224.0") || isInNet(host, "192.119.16.224","255.255.255.240") || isInNet(host, "216.21.170.144","255.255.255.240") || isInNet(host, "23.246.0.0","255.255.192.0") || isInNet(host, "37.77.184.0","255.255.255.0") || isInNet(host, "37.77.185.0","255.255.255.0") || isInNet(host, "37.77.188.0","255.255.255.0") || isInNet(host, "37.77.189.0","255.255.255.0") || isInNet(host, "37.77.190.0","255.255.255.0") || isInNet(host, "37.77.191.0","255.255.255.0") || isInNet(host, "69.53.229.0","255.255.255.0") || isInNet(host, "185.2.220.0","255.255.255.0") || isInNet(host, "185.2.221.0","255.255.255.0") || isInNet(host, "185.2.222.0","255.255.255.0") || isInNet(host, "185.2.223.0","255.255.255.0") || isInNet(host, "185.9.188.0","255.255.255.0") || isInNet(host, "192.173.80.0","255.255.192.0") || isInNet(host, "192.173.96.0","255.255.192.0")) { return 'DIRECT'; } if ( hostOrDomainIs(host, "lululemon.com") || hostOrDomainIs(host, "ticketmaster.com") || hostOrDomainIs(host, "ticketmaster.co.uk") || hostOrDomainIs(host, "wayfair.com")) { return 'DIRECT'; } if ( dnsDomainIs(host, ".cortana.ai") || dnsDomainIs(host, ".aadrm.com") || hostIs(host, "ajax.aspnetcdn.com") || dnsDomainIs(host, ".informationprotection.azure.com") || hostIs(host, "management.azure.com") || dnsDomainIs(host, ".azurerms.com") || dnsDomainIs(host, ".portal.cloudappsecurity.com") || hostIs(host, "platform.linkedin.com") || hostIs(host, "g.live.com") || dnsDomainIs(host, ".hip.live.com") || hostIs(host, "office.live.com") || hostIs(host, "officeapps.live.com") || dnsDomainIs(host, ".officeapps.live.com") || hostIs(host, "cdn.odc.officeapps.live.com") || hostIs(host, "cdn.uci.officeapps.live.com") || dnsDomainIs(host, ".lync.com") || hostIs(host, "admin.microsoft.com") || hostIs(host, "appsforoffice.microsoft.com") || dnsDomainIs(host, ".aria.microsoft.com") || dnsDomainIs(host, ".auth.microsoft.com") || hostIs(host, "c1.microsoft.com") || hostIs(host, "compass-ssl.microsoft.com") || hostIs(host, "compliance.microsoft.com") || dnsDomainIs(host, ".compliance.microsoft.com") || hostIs(host, "crl.microsoft.com") || dnsDomainIs(host, ".events.data.microsoft.com") || hostIs(host, "defender.microsoft.com") || hostIs(host, "docs.microsoft.com") || hostIs(host, "flow.microsoft.com") || dnsDomainIs(host, ".flow.microsoft.com") || hostIs(host, "go.microsoft.com") || hostIs(host, "graph.microsoft.com") || dnsDomainIs(host, ".manage.microsoft.com") || hostIs(host, "msdn.microsoft.com") || hostIs(host, "myanalytics.microsoft.com") || hostIs(host, "myanalytics-gcc.microsoft.com") || hostIs(host, "cdnprod.myanalytics.microsoft.com") || hostIs(host, "r.office.microsoft.com") || hostIs(host, "office15client.microsoft.com") || hostIs(host, "officecdn.microsoft.com") || hostIs(host, "officeclient.microsoft.com") || hostIs(host, "officepreviewredir.microsoft.com") || hostIs(host, "officeredir.microsoft.com") || hostIs(host, "o15.officeredir.microsoft.com") || hostIs(host, "security.microsoft.com") || dnsDomainIs(host, ".security.microsoft.com") || hostIs(host, "activation.sls.microsoft.com") || hostIs(host, "support.microsoft.com") || hostIs(host, "dgps.support.microsoft.com") || hostIs(host, "teams.microsoft.com") || dnsDomainIs(host, ".teams.microsoft.com") || hostIs(host, "technet.microsoft.com") || hostIs(host, "whiteboard.microsoft.com") || hostIs(host, "autologon.microsoftazuread-sso.com") || dnsDomainIs(host, ".microsoftonline-p.com") || hostIs(host, "login.microsoftonline-p.com") || hostIs(host, "nexus.microsoftonline-p.com") || dnsDomainIs(host, ".microsoftonline.com") || hostIs(host, "adminwebservice.microsoftonline.com") || hostIs(host, "becws.microsoftonline.com") || hostIs(host, "companymanager.microsoftonline.com") || hostIs(host, "login-us.microsoftonline.com") || hostIs(host, "logincert.microsoftonline.com") || hostIs(host, "loginex.microsoftonline.com") || hostIs(host, "passwordreset.microsoftonline.com") || hostIs(host, "api.passwordreset.microsoftonline.com") || hostIs(host, "provisioningapi.microsoftonline.com") || hostIs(host, "web.microsoftstream.com") || dnsDomainIs(host, ".msftidentity.com") || dnsDomainIs(host, ".msidentity.com") || hostIs(host, "prod.msocdn.com") || hostIs(host, "shellprod.msocdn.com") || dnsDomainIs(host, ".o365weve.com") || dnsDomainIs(host, ".office.com") || dnsDomainIs(host, ".online.office.com") || hostIs(host, "outlook.office.com") || dnsDomainIs(host, ".outlook.office.com") || hostIs(host, "protection.office.com") || dnsDomainIs(host, ".protection.office.com") || dnsDomainIs(host, ".office365.com") || hostIs(host, "outlook.office365.com") || hostIs(host, "r1.res.office365.com") || hostIs(host, "r3.res.office365.com") || hostIs(host, "r4.res.office365.com") || hostIs(host, "smtp.office365.com") || hostIs(host, "admin.onedrive.com") || hostIs(host, "www.onedrive.com") || dnsDomainIs(host, ".onenote.com") || dnsDomainIs(host, ".outlook.com") || dnsDomainIs(host, ".protection.outlook.com") || dnsDomainIs(host, ".mail.protection.outlook.com") || dnsDomainIs(host, ".powerapps.com") || hostIs(host, "make.powerapps.com") || dnsDomainIs(host, ".sfbassets.com") || dnsDomainIs(host, ".gr.global.aa-rt.sharepoint.com") || dnsDomainIs(host, ".sharepointonline.com") || dnsDomainIs(host, ".skype.com") || hostIs(host, "broadcast.skype.com") || dnsDomainIs(host, ".broadcast.skype.com") || dnsDomainIs(host, ".secure.skypeassets.com") || dnsDomainIs(host, ".skypeforbusiness.com") || hostIs(host, "activity.windows.com") || dnsDomainIs(host, ".activity.windows.com") || dnsDomainIs(host, ".wns.windows.com") || hostIs(host, "account.activedirectory.windowsazure.com") || dnsDomainIs(host, ".yammer.com") || hostIs(host, "aka.ms") || hostIs(host, "auth.gfx.ms") || dnsDomainIs(host, ".mstea.ms") || hostIs(host, "assets.onestore.ms") || hostIs(host, "oneclient.sfx.ms") || dnsDomainIs(host, ".svc.ms") || hostIs(host, "spoprod-a.akamaihd.net") || dnsDomainIs(host, ".azure-apim.net") || hostIs(host, "amp.azure.net") || hostIs(host, "informationprotection.hosting.portal.azure.net") || hostIs(host, "mlccdnprod.azureedge.net") || hostIs(host, "officecdn.microsoft.com.edgesuite.net") || hostIs(host, "apis.live.net") || hostIs(host, "clientconfig.microsoftonline-p.net") || dnsDomainIs(host, ".msauth.net") || dnsDomainIs(host, ".msauthimages.net") || dnsDomainIs(host, ".msecnd.net") || dnsDomainIs(host, ".msedge.net") || hostIs(host, "policykeyservice.dc.ad.msft.net") || dnsDomainIs(host, ".msftauth.net") || dnsDomainIs(host, ".msftauthimages.net") || hostIs(host, "account.office.net") || hostIs(host, "attachments.office.net") || hostIs(host, "insertmedia.bing.office.net") || dnsDomainIs(host, ".cdn.office.net") || hostIs(host, "workplaceanalytics.cdn.office.net") || dnsDomainIs(host, ".config.office.net") || hostIs(host, "support.content.office.net") || hostIs(host, "contentstorage.osi.office.net") || hostIs(host, "videocontent.osi.office.net") || hostIs(host, "videoplayercdn.osi.office.net") || hostIs(host, "suite.office.net") || dnsDomainIs(host, "cdn.onenote.net") || dnsDomainIs(host, ".phonefactor.net") || hostIs(host, "ecn.dev.virtualearth.net") || hostIs(host, "accounts.accesscontrol.windows.net") || hostIs(host, "mlccdn.blob.core.windows.net") || hostIs(host, "enterpriseregistration.windows.net") || hostIs(host, "graph.windows.net") || dnsDomainIs(host, ".keydelivery.mediaservices.windows.net") || dnsDomainIs(host, ".streaming.mediaservices.windows.net") || hostIs(host, "ocsp.int-x3.letsencrypt.org") || hostIs(host, "autodiscover.4qsckt.onmicrosoft.com") || hostIs(host, "4qsckt.sharepoint.com") || hostIs(host, "4qsckt-admin.sharepoint.com") || hostIs(host, "4qsckt-files.sharepoint.com") || hostIs(host, "4qsckt-my.sharepoint.com") || hostIs(host, "4qsckt-myfiles.sharepoint.com")) { return 'DIRECT'; } if ( url.substring(0, 6) === 'https:' ) { return 'PROXY safeview-8ssa81089-quangnguyen.devatron.net:3129; DIRECT'; } if ( url.substring(0, 5) === 'http:' ) { return 'PROXY safeview-8ssa81089-quangnguyen.devatron.net:3129; DIRECT'; } return 'DIRECT'; }
